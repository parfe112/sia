---
import { Image } from "astro:assets";
import logoImage from "../assets/images/logo.png";
import ThemeToggle from "./shared/ThemeToggle";
import {
  Home,
  FileText,
  FileCode,
  CircleDollarSign,
  Phone,
  MessageCircle,
} from "lucide-react";
---

<header
  class="fixed top-0 left-0 w-full z-50 transition-all duration-300"
  id="mainHeader"
>
  <div
    class="header-container transition-all duration-300 bg-primary-600 rounded-full mx-4 mt-4 md:mx-auto md:max-w-max shadow-lg hover:shadow-xl"
  >
    <!-- Desktop Navigation - Expandable -->
    <nav
      class="hidden md:flex items-center h-14 px-2 hover:px-6 transition-all duration-300 rounded-full relative"
    >
      <!-- Left side links -->
      <div class="flex items-center">
        <a
          href="/"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-primary-700 group min-w-10 hover:px-4"
        >
          <Home
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">Acasă</span>
        </a>

        <a
          href="/servicii"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-primary-700 group min-w-10 hover:px-4"
        >
          <FileCode
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">Servicii</span>
        </a>
        <a
          href="/preturi"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-primary-700 group min-w-10 hover:px-4"
        >
          <CircleDollarSign
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">Prețuri</span>
        </a>
      </div>

      <!-- Center elements with fancy background -->
      <div class="flex items-center mx-2 z-10 relative">
        <div
          class="absolute -inset-2 bg-primary-800 rounded-full blur-[1px] opacity-80"
        >
        </div>
        <div class="relative z-10 flex items-center space-x-3 p-1">
          <ThemeToggle client:load />
        </div>
      </div>

      <!-- Right side links -->
      <div class="flex items-center">
        <a
          href="/blog"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-primary-700 group min-w-10 hover:px-4"
        >
          <FileText
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">Blog</span>
        </a>
        <a
          href="/contact"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-primary-700 group min-w-10 hover:px-4"
        >
          <Phone
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">Contact</span>
        </a>

        <a
          href="https://wa.me/40770889907"
          target="_blank"
          aria-label="WhatsApp"
          class="nav-item text-white font-medium p-2 rounded-full flex items-center justify-center transition-all duration-300 hover:bg-green-600 group min-w-10 hover:px-4 bg-green-500 ml-1"
        >
          <MessageCircle
            size={20}
            className="group-hover:mr-2"
            stroke="#ffffff"
            strokeWidth={2.5}
          />
          <span class="nav-text hidden group-hover:inline">WhatsApp</span>
        </a>
      </div>
    </nav>

    <!-- Mobile Navigation - Always Compact -->
    <div class="md:hidden flex items-center justify-between h-14 px-4 relative">
      <a href="/" class="flex items-center">
        <Image
          src={logoImage}
          alt="SIA Skin Center Logo"
          width={32}
          height={32}
          class="h-8 w-auto"
          quality={100}
          format="png"
          loading="eager"
        />
      </a>

      <!-- Center Controls - Mobile -->
      <div
        class="flex items-center space-x-4 absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2"
      >
        <a
          href="tel:0770889907"
          class="flex items-center justify-center w-9 h-9 rounded-full bg-primary-800 text-white hover:bg-primary-900 transition-transform hover:scale-110 shadow-md"
        >
          <Phone size={18} stroke="#ffffff" strokeWidth={2.5} />
        </a>

        <ThemeToggle client:load />

        <a
          href="https://wa.me/40770889907"
          target="_blank"
          aria-label="WhatsApp"
          class="flex ml-4 items-center justify-center w-9 h-9 rounded-full bg-green-500 hover:bg-green-600 transition-transform hover:scale-110 shadow-md"
        >
          <MessageCircle
            size={18}
            stroke="#ffffff"
            strokeWidth={2.5}
            className="text-white"
          />
        </a>
      </div>

      <!-- Mobile menu button -->
      <button
        class="flex items-center justify-center w-10 h-10 rounded-full bg-primary-700 text-white hover:bg-primary-800 transition-colors z-10"
        aria-label="Menu"
        type="button"
        id="mobile-menu-toggle"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <line x1="4" x2="20" y1="12" y2="12"></line>
          <line x1="4" x2="20" y1="6" y2="6"></line>
          <line x1="4" x2="20" y1="18" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>

  <!-- Mobile menu -->
  <div
    id="mobile-menu"
    class="fixed inset-0 z-[9999] transform translate-x-full transition-transform duration-300 ease-in-out md:hidden bg-primary-900"
  >
    <div
      class="h-20 border-b border-primary-700 flex items-center justify-between px-4"
    >
      <a
        href="/"
        class="flex items-center space-x-3 text-white font-bold text-2xl"
      >
        <Image
          src={logoImage}
          alt="SIA Skin Center Logo"
          width={256}
          height={192}
          class="h-14 w-auto"
          quality={100}
          format="png"
          densities={[1, 2]}
          loading="eager"
        />
        <span class="text-white font-normal">Skin Center</span>
      </a>
      <!-- Close button -->
      <button
        class="flex items-center justify-center w-10 h-10 rounded-full bg-primary-700 text-white hover:bg-primary-800 transition-colors"
        id="mobile-menu-close"
      >
        <svg
          xmlns="http://www.w3.org/2000/svg"
          width="24"
          height="24"
          viewBox="0 0 24 24"
          fill="none"
          stroke="currentColor"
          stroke-width="2"
          stroke-linecap="round"
          stroke-linejoin="round"
        >
          <path d="M18 6 6 18"></path>
          <path d="m6 6 12 12"></path>
        </svg>
      </button>
    </div>

    <div
      class="container mx-auto px-4 py-8 overflow-y-auto"
      style="max-height: calc(100vh - 80px);"
    >
      <nav class="space-y-3">
        <a
          href="/"
          class="flex items-center px-5 py-3 text-lg text-white hover:bg-primary-800 rounded-xl transition-all mobile-menu-link"
        >
          <Home className="w-6 h-6 mr-3 text-white" stroke="#ffffff" />
          Acasă
        </a>

        <a
          href="/servicii"
          class="flex items-center px-5 py-3 text-lg text-white hover:bg-primary-800 rounded-xl transition-all mobile-menu-link"
        >
          <FileCode className="w-6 h-6 mr-3 text-white" stroke="#ffffff" />
          Servicii
        </a>

        <a
          href="/blog"
          class="flex items-center px-5 py-3 text-lg text-white hover:bg-primary-800 rounded-xl transition-all mobile-menu-link"
        >
          <FileText className="w-6 h-6 mr-3 text-white" stroke="#ffffff" />
          Blog
        </a>

        <a
          href="/preturi"
          class="flex items-center px-5 py-3 text-lg text-white hover:bg-primary-800 rounded-xl transition-all mobile-menu-link"
        >
          <CircleDollarSign
            className="w-6 h-6 mr-3 text-white"
            stroke="#ffffff"
          />
          Prețuri
        </a>

        <a
          href="/contact"
          class="flex items-center px-5 py-3 text-lg text-white hover:bg-primary-800 rounded-xl transition-all mobile-menu-link"
        >
          <Phone className="w-6 h-6 mr-3 text-white" stroke="#ffffff" />
          Contact
        </a>
      </nav>

      <div class="mt-10 pt-6 border-t border-primary-700">
        <div class="flex items-center justify-center space-x-4 mb-6">
          <a
            href="https://www.facebook.com/profile.php?id=61554965023675"
            target="_blank"
            class="bg-[#1877F2] p-3 rounded-full text-white hover:opacity-90 transition-opacity"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="w-5 h-5"
            >
              <path
                d="M22 12c0-5.52-4.48-10-10-10S2 6.48 2 12c0 4.84 3.44 8.87 8 9.8V15H8v-3h2V9.5C10 7.57 11.57 6 13.5 6H16v3h-2c-.55 0-1 .45-1 1v2h3v3h-3v6.95c5.05-.5 9-4.76 9-9.95z"
              ></path>
            </svg>
          </a>
          <a
            href="https://www.instagram.com/sia_epilare_definitiva/"
            target="_blank"
            class="bg-gradient-to-r from-[#FCAF45] via-[#E1306C] to-[#5851DB] p-3 rounded-full text-white hover:opacity-90 transition-opacity"
          >
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
              fill="currentColor"
              class="w-5 h-5"
            >
              <path
                d="M12 2.163c3.204 0 3.584.012 4.85.07 3.252.148 4.771 1.691 4.919 4.919.058 1.265.069 1.645.069 4.849 0 3.205-.012 3.584-.069 4.849-.149 3.225-1.664 4.771-4.919 4.919-1.266.058-1.644.07-4.85.07-3.204 0-3.584-.012-4.849-.07-3.26-.149-4.771-1.699-4.919-4.92-.058-1.265-.07-1.644-.07-4.849 0-3.204.013-3.583.07-4.849.149-3.227 1.664-4.771 4.919-4.919 1.266-.057 1.645-.069 4.849-.069zM12 0C8.741 0 8.333.014 7.053.072 2.695.272.273 2.69.073 7.052.014 8.333 0 8.741 0 12c0 3.259.014 3.668.072 4.948.2 4.358 2.618 6.78 6.98 6.98C8.333 23.986 8.741 24 12 24c3.259 0 3.668-.014 4.948-.072 4.354-.2 6.782-2.618 6.979-6.98.059-1.28.073-1.689.073-4.948 0-3.259-.014-3.667-.072-4.947-.196-4.354-2.617-6.78-6.979-6.98C15.668.014 15.259 0 12 0zm0 5.838a6.162 6.162 0 100 12.324 6.162 6.162 0 000-12.324zM12 16a4 4 0 110-8 4 4 0 010 8zm6.406-11.845a1.44 1.44 0 100 2.881 1.44 1.44 0 000-2.881z"
              ></path>
            </svg>
          </a>
          <a
            href="https://wa.me/40770889907"
            target="_blank"
            class="bg-green-500 p-3 rounded-full text-white hover:bg-green-600 transition-all"
          >
            <MessageCircle size={20} stroke="#ffffff" strokeWidth={2.5} />
          </a>
        </div>

        <a
          href="/contact"
          class="block w-full bg-primary-600 hover:bg-primary-700 text-white font-medium px-6 py-3 rounded-xl transition-all text-center shadow-sm hover:shadow-md mobile-menu-link"
        >
          Programare
        </a>
      </div>
    </div>
  </div>

  <!-- Mobile menu overlay -->
  <div
    id="mobile-menu-overlay"
    class="fixed inset-0 bg-black/50 z-[9000] hidden md:hidden"
  >
  </div>
</header>

<script>
  // Setup mobile menu functionality
  document.addEventListener("DOMContentLoaded", () => {
    const mobileMenu = document.getElementById("mobile-menu");
    const mobileMenuOverlay = document.getElementById("mobile-menu-overlay");
    const mobileMenuToggle = document.getElementById("mobile-menu-toggle");
    const mobileMenuClose = document.getElementById("mobile-menu-close");
    const mobileMenuLinks = document.querySelectorAll(".mobile-menu-link");

    function toggleMobileMenu() {
      if (mobileMenu && mobileMenuOverlay) {
        mobileMenu.classList.toggle("translate-x-full");
        mobileMenuOverlay.classList.toggle("hidden");
        document.body.classList.toggle("overflow-hidden");
      }
    }

    // Toggle menu open
    mobileMenuToggle?.addEventListener("click", toggleMobileMenu);

    // Toggle menu closed
    mobileMenuClose?.addEventListener("click", toggleMobileMenu);
    mobileMenuOverlay?.addEventListener("click", toggleMobileMenu);

    // Close menu when a link is clicked
    mobileMenuLinks.forEach((link) => {
      link.addEventListener("click", toggleMobileMenu);
    });
  });

  // Header interaction - expand on hover/scroll
  document.addEventListener("DOMContentLoaded", () => {
    const header = document.getElementById("mainHeader");
    const headerContainer = header?.querySelector(".header-container");

    // Add hover class to header container on desktop
    headerContainer?.addEventListener("mouseenter", () => {
      if (window.innerWidth >= 768) {
        // Only on desktop
        headerContainer.classList.add("expanded");

        // Show all nav text
        const navTexts = headerContainer.querySelectorAll(".nav-text");
        navTexts.forEach((text) => {
          text.classList.remove("hidden");
          text.classList.add("inline");
        });

        // Add margin to icons
        const navItems = headerContainer.querySelectorAll(".nav-item");
        navItems.forEach((item) => {
          const icon = item.querySelector("svg");
          if (icon) icon.classList.add("mr-2");
        });
      }
    });

    headerContainer?.addEventListener("mouseleave", () => {
      if (window.innerWidth >= 768) {
        // Only on desktop
        headerContainer.classList.remove("expanded");

        // Hide all nav text
        const navTexts = headerContainer.querySelectorAll(".nav-text");
        navTexts.forEach((text) => {
          text.classList.add("hidden");
          text.classList.remove("inline");
        });

        // Remove margin from icons
        const navItems = headerContainer.querySelectorAll(".nav-item");
        navItems.forEach((item) => {
          const icon = item.querySelector("svg");
          if (icon) icon.classList.remove("mr-2");
        });
      }
    });
  });
</script>

<style>
  /* Custom styles for the animated header */
  .header-container {
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
  }

  .header-container.expanded {
    padding-left: 2.5rem;
    padding-right: 2.5rem;
  }

  /* Add a subtle shadow effect */
  .header-container {
    box-shadow:
      0 4px 6px -1px rgba(0, 0, 0, 0.1),
      0 2px 4px -1px rgba(0, 0, 0, 0.06);
  }

  /* Enhance hover effect */
  .nav-item {
    position: relative;
    overflow: hidden;
  }

  .nav-item::after {
    content: "";
    position: absolute;
    bottom: 0;
    left: 50%;
    width: 0;
    height: 2px;
    background-color: white;
    transition: all 0.3s ease;
    opacity: 0;
    transform: translateX(-50%);
  }

  .nav-item:hover::after {
    width: 80%;
    opacity: 0.7;
  }

  /* Add glass morphism effect for modern look */
  @supports (backdrop-filter: blur(10px)) {
    .header-container {
      background-color: rgba(98, 34, 103, 0.9);
      backdrop-filter: blur(10px);
    }
  }
</style>
